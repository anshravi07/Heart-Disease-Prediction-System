{% extends "base.html" %}

{% block title %}Heart Health Predictor - Check Your Risk{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="card shadow-lg rounded-lg mb-4 animate__animated animate__fadeIn">
            <div class="card-header bg-gradient-primary text-white">
                <h2 class="mb-0"><i class="fas fa-heartbeat me-2"></i>Heart Disease Risk Assessment</h2>
            </div>
            <div class="card-body">
                <div class="alert alert-info shadow-sm">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-info-circle me-3 fa-2x"></i>
                        <div>
                            <strong class="d-block mb-1">How it works:</strong>
                            Enter your heart health information below, and our AI model will assess your risk of heart disease.
                        </div>
                    </div>
                </div>
                
                <form action="/predict" method="post" id="heart-form" class="needs-validation" novalidate>
                    <div class="row mt-4">
                        <div class="col-12 mb-4">
                            <h4 class="text-primary border-bottom pb-2"><i class="fas fa-user-md me-2"></i>Basic Information</h4>
                        </div>
                        
                        <!-- Basic Information (First 5 features) -->
                        {% for feature in features[:5] %}
                        <div class="col-md-6 col-lg-4 mb-4">
                            <div class="form-group">
                                <label for="{{ feature }}" class="form-label">
                                    {{ descriptions[feature] }}
                                    {% if feature in tooltips %}
                                    <i class="fas fa-info-circle text-primary" 
                                       data-bs-toggle="tooltip" 
                                       title="{{ tooltips[feature] }}"></i>
                                    {% endif %}
                                </label>
                                
                                {% if feature == 'sex' %}
                                <select class="form-select form-control-lg" id="{{ feature }}" name="{{ feature }}" required>
                                    <option value="" disabled selected>Select your gender</option>
                                    <option value="1">Male</option>
                                    <option value="0">Female</option>
                                </select>
                                {% elif feature == 'cp' %}
                                <select class="form-select form-control-lg" id="{{ feature }}" name="{{ feature }}" required>
                                    <option value="" disabled selected>Select chest pain type</option>
                                    <option value="0">Typical Angina</option>
                                    <option value="1">Atypical Angina</option>
                                    <option value="2">Non-anginal Pain</option>
                                    <option value="3">Asymptomatic</option>
                                </select>
                                {% else %}
                                <input type="number" 
                                       class="form-control form-control-lg" 
                                       id="{{ feature }}" 
                                       name="{{ feature }}" 
                                       required
                                       {% if feature == 'age' %}
                                       min="18" max="100" placeholder="Enter your age"
                                       {% elif feature == 'trestbps' %}
                                       min="80" max="240" placeholder="Enter resting BP"
                                       {% elif feature == 'thalach' %}
                                       min="60" max="220" placeholder="Enter max heart rate"
                                       {% endif %}
                                >
                                {% endif %}
                                
                                {% if feature == 'trestbps' %}
                                <small class="form-text text-muted">Normal range: 90-120 mm Hg</small>
                                {% elif feature == 'thalach' %}
                                <small class="form-text text-muted">Normal range: 60-100 bpm at rest</small>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                        
                        <div class="col-12 mt-2 mb-4">
                            <h4 class="text-primary border-bottom pb-2"><i class="fas fa-flask me-2"></i>Advanced Clinical Indicators</h4>
                        </div>
                        
                        <!-- Advanced Information (Next 5 features) -->
                        {% for feature in features[5:] %}
                        <div class="col-md-6 col-lg-4 mb-4">
                            <div class="form-group">
                                <label for="{{ feature }}" class="form-label">
                                    {{ descriptions[feature] }}
                                    {% if feature in tooltips %}
                                    <i class="fas fa-info-circle text-primary" 
                                       data-bs-toggle="tooltip" 
                                       title="{{ tooltips[feature] }}"></i>
                                    {% endif %}
                                </label>
                                
                                {% if feature == 'fbs' or feature == 'exang' %}
                                <select class="form-select form-control-lg" id="{{ feature }}" name="{{ feature }}" required>
                                    <option value="" disabled selected>Select option</option>
                                    <option value="1">Yes</option>
                                    <option value="0">No</option>
                                </select>
                                {% elif feature == 'restecg' %}
                                <select class="form-select form-control-lg" id="{{ feature }}" name="{{ feature }}" required>
                                    <option value="" disabled selected>Select ECG result</option>
                                    <option value="0">Normal</option>
                                    <option value="1">ST-T Wave Abnormality</option>
                                    <option value="2">Left Ventricular Hypertrophy</option>
                                </select>
                                {% else %}
                                <input type="number" 
                                       class="form-control form-control-lg" 
                                       id="{{ feature }}" 
                                       name="{{ feature }}" 
                                       required
                                       {% if feature == 'chol' %}
                                       min="100" max="600" placeholder="Enter cholesterol"
                                       {% elif feature == 'oldpeak' %}
                                       min="0" max="10" step="0.1" placeholder="Enter ST depression"
                                       {% endif %}
                                >
                                {% endif %}
                                
                                {% if feature == 'chol' %}
                                <small class="form-text text-muted">Normal range: < 200 mg/dl</small>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg shadow-lg">
                            <i class="fas fa-heartbeat me-2"></i>Check My Heart Health
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-4 shadow-lg rounded-lg animate__animated animate__fadeIn animate__delay-1s">
            <div class="card-header bg-gradient-info text-white">
                <h3 class="mb-0"><i class="fas fa-question-circle me-2"></i>What is this tool?</h3>
            </div>
            <div class="card-body">
                <p class="lead">This Heart Disease Prediction tool uses machine learning to assess your risk of heart disease based on key health parameters. The model has been trained on medical data and can provide an initial risk assessment.</p>
                
                <div class="alert alert-warning shadow-sm">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-exclamation-triangle me-3 fa-2x"></i>
                        <div>
                            <strong class="d-block mb-1">Important:</strong>
                            This tool is for educational purposes only and does not replace professional medical advice. Always consult with a healthcare provider for proper diagnosis and treatment.
                        </div>
                    </div>
                </div>
                
                <h5 class="mt-4"><i class="fas fa-clipboard-list me-2 text-primary"></i>The 10 Key Parameters We Use:</h5>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <div class="card mb-3 shadow-sm hover-card">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-user me-2 text-primary"></i>Basic Information</h6>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Age:</strong> Heart disease risk increases with age</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Sex:</strong> Men are generally at higher risk than women</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Chest Pain Type:</strong> The type of chest pain experienced is a significant indicator</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Resting Blood Pressure:</strong> Higher blood pressure increases risk</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Maximum Heart Rate:</strong> Lower maximum heart rate may indicate higher risk</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card mb-3 shadow-sm hover-card">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-flask me-2 text-primary"></i>Clinical Indicators</h6>
                                <ul class="list-group list-group-flush">
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Cholesterol:</strong> Higher levels increase heart disease risk</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Fasting Blood Sugar:</strong> Elevated levels indicate diabetes risk</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Resting ECG:</strong> Abnormal results may indicate heart issues</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>Exercise Induced Angina:</strong> Chest pain during exercise is a warning sign</li>
                                    <li class="list-group-item border-0 ps-0"><i class="fas fa-angle-right me-2 text-primary"></i><strong>ST Depression:</strong> Abnormal ECG readings during exercise</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <p class="mt-3">For more information, visit our <a href="/faq" class="btn btn-outline-primary btn-sm"><i class="fas fa-question-circle me-1"></i>FAQ page</a></p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        });
        
        // Form validation
        const form = document.getElementById('heart-form');
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        }, false);
    });
</script>
{% endblock %} 